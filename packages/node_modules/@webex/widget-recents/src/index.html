
<!DOCTYPE html>
<html>
<head>
  <title>Recents Widget Demo</title>
  <meta charset="utf8"/>
</head>
<body>
<div style="float: left;">
  <h2>Recents Widget</h2>
  <p>
    <label for="accessTokenInput">Access Token</label>
    <input type="password" placeholder="access token" id="accessTokenInput" value="<%= process.env.WEBEX_ACCESS_TOKEN %>" />
  </p>
  <p>
    <label for="basicModeInput">Enable Basic Mode</label>
    <input type="checkbox" id="basicModeInput"/>
  </p>

  <p>
    <button onClick="createWidget()">Create Widget</button>
    <button onClick="removeWidget()">Remove Widget</button>
    <button onClick="createWidgetWithSdk()">Create Widget w/ SDK</button>
  </p>

  <div style="width: 500px; height: 500px; border: 1px solid black">
    <div id="webex-widget-global"></div>
  </div>

  <div style="width: 500px; height: 500px; border: 1px solid black">
    <div id="webex-widget-global2"></div>
  </div>


  <div>Event: <span id="widget-events"></span></div>
</div>
<script crossorigin src="//unpkg.com/webex@1.137.2/umd/webex.min.js"></script>


<script type="text/javascript">

var widgetEl = document.getElementById('webex-widget-global');
var widgetEventsEl = document.getElementById('widget-events');
var accessTokenInput = document.getElementById('accessTokenInput');
var basicModeInput = document.getElementById('basicModeInput');


function createWidget() {
  var widget = webex.widget(widgetEl);
  widget.recentsWidget({
    accessToken: accessTokenInput.value,
    basicMode: basicModeInput.checked,
    onEvent: function(name, data) {
      widgetEventsEl.innerText = name+'\n'+JSON.stringify(data, null, 2);
      console.log(data);
    }
  });
}

function createWidgetWithSdk(sdk){
  var widget = webex.widget(document.getElementById('webex-widget-global2'));
  widget.recentsWidget({
    sdkInstance: sdk,
    onEvent: function(name, data) {
      console.log(data);
    }
  });
  return widget;
}

function removeWidget() {
  var widget = webex.widget(widgetEl);

  if (widget.remove) {
    widget.remove();
  }
}
const sparkProxy = {
  rooms: new Proxy(webex, {get: (source, target) => {
      return (...args) => {
        const origRequest = webex.rooms.request;
        webex.rooms.request = (...args) => {
          console.log('fancy request.');
          return origRequest.bind(webex.rooms)(...args);
        }
        try {
          return webex.rooms[target](...args);
        } finally {
          webex.rooms.request = origRequest;
        }
      }
    }})
}
</script>


<script>
  console.log('Loading webex.js sdk')
</script>

</body>
</html>
